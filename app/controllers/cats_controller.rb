class CatsController < ApplicationController
  skip_before_action :authenticate_user!, only: :index
  before_action :set_cat, only: [:show, :destroy]

  # def index
  #   @cats = Cat.all

  #   @markers = @cats.geocoded.map do |cat|
  #     {
  #       lat: cat.latitude,
  #       lng: cat.longitude,
  #       info_window: render_to_string(partial: "info_window", locals: { cat: cat })
  #     }
  #   end
  # end
  def index
    @cats = Cat.geocoded

    @markers = @cats.map do |cat|
      {
        lat: cat.latitude,
        lng: cat.longitude,
        info_window: render_to_string(partial: "info_window", locals: { cat: cat }),
        image_url: helpers.asset_url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAkFBMVEX///8AAADl5eXk5OTz8/P8/Pzt7e3w8PD19fXp6enu7u74+Pjq6urAwMC1tbXR0dHZ2dlhYWFJSUmvr6+AgIArKyu9vb2UlJQ7OzuNjY3JycmpqaleXl7Nzc1WVlYYGBhCQkKPj48NDQ2fn592dnZubm4iIiKGhoZNTU0lJSU0NDRXV1cVFRV5eXkLCws9PT3xzmq5AAAX/UlEQVR4nM1daXvjLK92jW28ZWvaZpp02rSdLtPp8v//3cG7BAKD4bneoy++QmyMDGi5JSCKoihlcVyKaxLHcS6uRRyzplj8zLpiVolr3RezsTgminPWVSKKY3GJeLw5rk6Hr7vLj9fP74uGvj///rq8+/N2utkwxst0qiQSD9dNJfFYCSpmdHF/d0YX/1cc8oxvt/u3f08XZnp6v9pv8jyri2AcxnoOWcdKIbHCOlbkYvEzR8WsKy6KNEq3z7vXGd4gve4OqxQ1jtGskMVsKk7V4jRNq6IouLgm4pqLayau4pLqi0u6OEvTqEqK1eHegbmJ3p83RVI2r8zJuueKS7I4Yow146MS16TpaXFtvwMuLq2K0yLbnl4WcTfQy7rI6pg3w7yvO2YsbseImLN9cUUX03c346Jts7i2be57WlPMcDHHd7PD2Yu9jn4Om0qtu3kl74qHOVP0wkIqjnHxWIEYtBQrjOZQ3D3U27WiTvLTZQD2OjqfklZQ9BzG+JVdH/assJ6VSYagYvEry7KyqqpcXBNx5eKai6u4cLqYujtP1v+CsdfR7obnZVN3Kd5BvBIUNw1NpuISF/eylNGylGWwmNHFYvI9PwTmr6GHQ54Ug9BkstCkihlZHPnqw+S4+w/Y62h3LJGa9NCHuFc0fSgXs+YT/Q43+yi6XC/pQ6QPEz1xw38tVenql0Nrha1239Dlr78OT32s0nyuIaZ2iy5lUJZmTBGaneKjio8fNi3cvZ1W2zqNMKX1dnW63dnUcL2GspQNsrRXfFNximTpUEwovthKHxbpdm58ft8dVnE0R/HqcPc9U9PlhlJ81vpQ04eS8RJjm6bc3pm/+9e6mGVuonp9dW2sbxdncUzaNErXdsKCjX3YKo+yUx5l2akcce10StnplLJVNWNxKfTUm6k5L+vagbuBsrXR4HvL07aBOWxJNjRwaHeeN0q7BMVRhPUh9hZiUpYW5VrvN3xe/V7A3UC/r/Sa9eHYNMEgS2X/cLE+rLd6++Vr48FeR5svbe3/ttlSD5iNGq4zXsaxTBRHz7oGvN/IAnMZpTda7+s56xRf1xJx6TqLMUNx70w1PmIirlxcq87HqqlivtW9/Y1pGnxjZGdNlsa3mrfcM961pO6cwcG3HRooFQsndt63QMXliX7x617ffQ9bA4PphU4o7TVz/cShywGcCJ1v4aYPaWn3Yeqm7cWt4d/jxZv2vxVtDuwKqNrn9aGLjx+Tn/XjaOAgir4uvg3//rm4yA38kzx+NvPB2vWPIitJ01qwpIj5a55mYhheXBj0h/j32fT4ijRhn7mDpImQtkCKL8Zu0h/qXSczf0KSiJv+aP/93dRhlsB76rUv7ez1xksZ1IfVO/Git2qOwag1XrX/trpvb64hpeynn9yGwwFNlPHBWoUNU0bYGpc6/QCItXdqR3L77+tsJcTXfWCRCWSMXNHEFfEZZz59R933v9P8u7kwf4CR1sT71824I9BEbHkraGJGwobEC+64DYNpf7dGXl51//6aryghXJnnCIGMen3IZjU+IUStOlDYM+bbh9psjHXiKz8D7ymmPeAOTZyBDdNHpeqzGOdWHA4m3pn8dzPU925TV6bCzbeRAWRMDGgihg2viIotqRgfId3hSUiaDLuJ1E/90ow7BYliJjRR1YeqM2O2YSAdxmcO1N+gpXb1/VZZjGzRRK0HrDD4UVozGH2OT10T/25ArZagAFfMuD8UyGhAE7l0TZUhavm1WzqC53Yvu7v798ufj+tXKmiqN3skUmz/r9QMgM6giY9yfeRo05EZrMK0s61UEexfbaRqIZqo1DavmwElDgyKcWylYKNJA6GvLntPhH9IoYmKCnJCYbhrMNHCCGxpIz+4B2giU/pQ6I68LMseTSxH2DCvUsVUs21CS6rcC8Yikx9c5T2aWLZo4sQOgSYCbSHX8+QC8UYauMNMtjBr/Sk9+BuAgdZoYiV5Ew8OWoJSzjb01xas41LjnhrTxAZNHPqwsc8lj+XBVhC0ZITEDaRzQmZZvIyAjx9j119Q62PVPWxYt6hcInn0T049eLhYSkZIA7EoDdQ/eY8m1h0KWvcgY61DE2U94TQHKW/OlqxfVMvfpsb6cAZNjKXHnaSoIupcyMrNIF/zmwYZNT6+BBu6RSPMcbI5srfrJb34pPHxIyJgX0q5B06WjD6uYUc/9m+SrJsdt/Ge2rRCSZc52aJR5cegra/YkvQxT1kbcp5HE7f4ORdvQn2rO105vEzyNLYShwhNjEY0McLRpQ83BiP/5CGXt+FckHdugybWUic4aXplACwhF8HN8aP7LJ7NTSykJtqLto68B+nFBR1S1JBk4G+LWTSxxCFsa9BpIL/00pbcJNsjeva+nEMTc2yPnF0ZjAJkmLqImqiPjIy0TjS5iaM+xLo+c+bQJaFLQ9aYTUcZevgzhSkaSXcL0BYldgoskW1IfgZNS1+Or8TD7taIJkpixtqXARQgVfHR9Z3YBCtiCU3Mk4RznjTXJMXoWLKAQzKO6kbOIwdDXndpwpO8ZytPsPe09XtTQ4vQC0wOZltPeJxuUPo31odoiF0uYTCExl/wVgRInLX6sDqiFzn5hBN5C1NHO7gl7CseVTSRt/BbioIC+jwXM3kbNa5WVEtIB3w04GLLloQmYnx0PgmBJjekW6XZqD5JKapj3/Qf4R8iO302jURLS3G2npys0olQUsp1G1ZEaGITKEQ27N/FDHq6wFQYzoqQqdGgEhOa2Gds5JfyLUvJB2pzhIQAoTl2Tuo+N3FCEwskSF3dXkwuUTWJXC02QGiSrQomo4kZMn0WybORqrncey0tHqMRjsde3HEFTUSa2q8LPdS+E/AsE+rEbYzRxDhHamzlySGZQ2VBPknw0ksPsrZIoF+4TCUhIjMK58hHvDUEzaknyXsqkPxbZHJLtMAC934t+qyrFKGJHKEzQVLunXXGQlUPCVa3a5L0k2hAE3P431KLVCJsx8+S99wXhDL8GxkzoYkn+a8QxFxW5Ad5aQFrbOzOSR9Ce8Y+vjVHqYPDbx0aNRKE68/RtNI5Re6Vr0QD5OJJBWERKQyWjmhigaLSYZb2NOTmZQT5srDCx3rUhyhz08MylMg1mu+Oz6gE8/B+8UEfYiPLf/VZT87q4iHA6EFx4W3LYS48fihJP/3f0tEC23QJQiMTDO6d8iTPG1mawGiKY9BAS4v8YD+XpiU493c9mlggLYKM3+3j+8vzsumxaBuCT/9xioZpE6hoOEQiFrxjWGz/dOu+rFdJkbQjZ0BfJVjdRvgXYh6mUOaBqYDGriPyhqxAF1qyRBoTbPZtmrfSFALGa/LOC1ezUb+Wd4b8hQ0U4eduRCKocfyGSmKTSzTYA9qf36JghlA4kSvNmXAS1YV1+Lwem9X4dyJE7hvlXnNoPE4GDaGvrV+upCm7kHvYWSJo1hx4HcUIZJumIZV+Z+s4Ltvqy/ElWoJifJfFUcGhFwewLmpFpZ1x7Blg8+UQpmU+8CKKYXvgmmSynVZRYc+EE280A65YafLAICcocE85dzbrPnyDTw7JiTTBadeIGig0ca4O5f1YIJreAURfQAO2u4EyoKkqqfVENS4tPrB3vomv6Qat0MaRgLpL+XpqN87a4f6BfF9AGnoS71HE4bxU71aA3dmkM88AaUO+zj6si6OcdSogI/fi7DANsDmdW+qeStCqYcj+ICWlPBdn8k0DZJt4h76wMIXING1OSAsiZ7T+8sUkgDx9qEdQ1QoJHjo7QbIyZ2AOly3qtOQZo4HC4wb90viA2EYxh2l91X1Hng4GHJcnNKo0MgwncJqN/4WhUZn8OISy4BF547rhj5c7G719dfH+IvIza2CX/EF5EzqkCy+iMjr7ARJoG/KbiBC1+IeiTtpHkMYw5SwuRqAkckyElgnUdEbaUfsETvk3gJoLFv+S5JN1Iugb1gT8X0OmF1rOaDCqAqy26GhJevJEYK68wrYbtolBxqZhkgRYbdGRX94JiKU9wQ41TDCk9Q063yWubSS/eClEYOCkvNc/gjDVs91tXuQnaiAUZskhTsbTipoQZndHFhsrWbbWlkMkQrS4tFfeJSavKNQSDtFE1Ib5gjgWHXnl8C3hEKlyrRgIJko9hSmah3ayFJtj2mSGEEcj9ORltyFZaqcPseGm/RThGHRf+AgJ6UM7mwanjD1p7vFexg3Iy0VENg30yU0PoWibZgs9r80UJPJCvsHU+7DzLSIp01DjvnlF1SR68OEQ1HO28g8bQspcoy4CqsPla3Yi2T+E6YMmiAtBGRpBF2Bl3kQekVLY1hfkNZiwZiRFNJDtY0gOPYBvON7ebLC2lpBRrfEuFmdgUOSRH4Wxthv0y0AQGNaEEYMex+KRjInxUij/jCF06Pqd6VuowPhiWr54LnoE1WyQDjNGeOFiBk38KwjePZBHeAaax1vEoTEighaYzn8Eb/LIycCxp5n4oYZDWnMuXtBFkUeuMqyGRxmcPCaoGWG9tNkWkkEPwxTGgC/LCO1QalIXaAiSQcRwKE1DSzZ06AjF8VNTLgYmFNslrZ+QroXPsg85FwOqC9N3Q68nMYZQkH5H58Ucyvk0sF2GcxrwECQnrLSjkSctR9sgQJ9EUZ1r8tokwh1EclgG5XBxMB/a3Q9Jps1NlAlH2EgOpUiqJy0Ozsi5iXENJ6YesMdgL8mhvFejHy3OG0L5pXUcMZSqr/9weDUhOZrRqob/HYfQNDkW7S6KsF6tE4z9d9I9/f/Rh0ga9HqbztWXCEcGSY0fdh4u5RB2xU+qNl5rK+F0NRJECcvh0p05oGPx1nOIF9JoCHu35C1h9eFSWQrruGl6grEYbTirixcg34+GhMPaNAv1Ie6ufqUzSpTV6QuLt4e1SxfaNNLatW6fKA4np2b9IR6BtP0a1rc4L+MQWmj7fqVzzZEio9eQYoWv8U6DcrjMt0DtLNKk7lY6Zz+zrcf5apoAYlAOl/mHaB1wOe6bWM+v5cZwtgbpC3p2tfWBF4hgDY/ZuPNHjAQQ2Xwcv9bg0YGS2jpalI2BhtqmYN1K5zznFQzekhMAnympyVj6uQhIi7A2uPDgp2r2TcypfTGoVAtk0ugiX14rumRasuoCicxGWEz7JiJlQAWYUd6oTggERfWXZEU9wgravU2mfRNR4+Y41AFWAXb2nGhJqgJ8/r4/YKebhzy/makcjVJdWCjAYpKJFkRmUCT+puLdPIz6rTChpCccFyRLdU5ksNzLhhZE16R9ovBOWDliQUWGrbboCRoDdo+Qynt9xYBDFnPkGKiWNRrFOmh84TYDNLkv6kbKisNTWNp9ExPznnvIJtBJmlA50C05ZwnjPffymqdpldT1uAftzL6JSJ2cNe8ImU/jnpyI902slX0T4xIlpSkDEa1+0hyrE9LJd86nwXtfloV6CgvelE5BSdAmAroIdEAOnR1gZBSvCnwKS9ztQYtioLJORLJWh6EEDJG6Ok94D9rW4o4L+YwS7ANK8wBndGmkaUDT2zEETO0jHCv7CKeoo99MVWg60WNrVpkcExWQ73Pd7mEGORTd2RZhXFvS69ispmdioHVdDbmZpViKr+vu5IBulKJTWJA4lfxESZ2T4jSg2eZmtKl7smtOYTHtqy8haWfqRQGTE52MNnVf/Vh3hiUeitiskDwHClgNmGDqcoAPhqKbhHx4CktntVW5uCYp3kBRkthy8IxwUQPG11xMGtwv2+bsPMHOYLVF8PxDluGOwpEoea0BIQyCMegStZDPKBlPJWPkqWQYEURxQsXsVHuROup3EZnWfkiE0weeUvOZzrF0vOoZ1aWgFMpcDJad6LD1Hz73ZaWcQ9qhGI27n7fHlki7WCHESw0uvUs+TrAcWnscCiO591HLDh/YadFEfKazfGYXirYRTjy234IpRGuURntml/5M58x07hoxCl/gDYGW49urQ/ncNa6eYamey50Zzs4jPcDDJNmD+cC2Hj629e+bDpP7sJ+HYODmUjNRaJ/cwvr7NPAYKoSoW3ckkyT7WKKyE3UMx/CUzlKabmjWa5YYHvqxKh+2vJDOdgwqZ1gO58L3sjRWTyXrznTmpnNIdWsMd62tHAjYtws8SbN+PIfUpA/7M50LqStQXFi/KeLV71CrSK2UhST1X8dTq/FJq8IszZrj9Bq7tDmfXFwr2T6VfEVTiCmQlz+/l2iqnFm8Ec2vMsFPy05W844d4Fu0gzbTnOmMgPyArryGLPY2kfOTnrP+XPj5M51bDrk03T6RWgwaZKJofuGafPT4C2caDukznSNWS+MNnK2eBo7BqDTvWSTS7g0/RdczmjOd46KXpR2wUYurmKjSR8LHxzse7eBIM1kKqcLgd6PtMtHulstBlipo4qgtOpkkS5tPNBezgOu2FZqLcGdy1sexijoZ0vwrnXiMORzGcnungrrg+R9wewGZZuxuWYperOtu7MWyxh/RRKUP29kq2+ByvtQ26EouSGa7W9l947k7IkD0IR6lsYomAknTFissSh83aEgUkBGkUfyXBjzmfbuFpJk707nv6b74Vq5NMjbygBjwRMbES+Wrf7UpCaLBUFuQaCLikHXFqhUqJxEXAffC0L0DkqKKX0oOOIxVfTjEgDs0Me2ttnQozhUGfslIZhFc/+utUq5YhS9tsHdst7Da6glNbIqjSDrTuWkyi9lUrLZfSSNOHsNyqEX01TB6092jic0GbWFEE6NRWzRjuWFcRZcIdXXjsQ27Qjq8W9VPL12gMB5kacuhEU2E+nBwjFOVxUsiLsNPAY5z7ojmj6v1f2XQTZI1PkYTIYrR/8zLHmSsCN1Orsvg65cQKab/SAaJqM+hIts9gyayQZbCYqL2nQYrKtZXfvbcyw2lDXMCPHiOEOQ0aLlZNHG0C2AxhRLq17lV2/0yNt8PG1rZU2G7dcMCUHx6fYj6sGRIHw7F+W8iIvFu9lPj4/PX2Tp34edqv9WZMjEB034fa6mzGNaHEE1MIKqPx/NYXGWUHHmbj4El29Xp8c+7NkH69fLlcf/btKtKqhhWgn7VlVZ+kGjiKEuhtpBARlKx24fbUx5vN8eb9b6l9Xp13LBas1kRJPI0zJfW4BoVn1GWRrP6cHCqctKxvw5xbqGeVmTnC2cCsiLpQwpNHCOkXR9OSAAydWpqMgo7OcA5VBo6kv7Z6yZjPWwYQ+OlZgyjiV1xltVlG+XOGru04uJaVWmVCUqrtCuuKi5ua8w+GvD99d/044r2P3eZaGAqGtRE56sGNpzaLYqzWrS7K67a0wFxpoLsW8jFMuA/0N8Qh7Ni2mv2ETnxmBKaEz4hFVvqw9FtzLa6MO+t106HEhWPmrfcs2xUfM0LLfSh0ccfi8uhWDyoTZq5DzVYV1ozft8Ki7YPFWde5+M35+XKaGJRdN+BLs62elj/yv/0xI0eNrjf8g6YLxrYsG03hA17NBEWg9gTVAuEtkBqsuB7vYH98ObD5OZNv0/v06ppwgCqNXc7aAtaH0qM11NxEj1qGyLoZa1JIjaS8ExMld6mIz5ozeGUmziyEhP+4VBco64tzJHCj6sblyMcspurD2N991vAygyHLmiiKmnG4jjdzrkPn7vDal7AFqvDbi5yfN4gkaKRNHSxrBYyRR9SEFx/99H83fve3N2eVttMttGFwBIm+c6mhut1/0qo+Hp9WDFaWzC992THYV+c7x0WVX5fn9/v7+7u7t/P1w4J4df7FqoArDAaNmwbSGj8GTRxKi6oYp7f/JcRGjE+jznP6v6VA2yYdy2RYEMKTUwmNBEhUQOayCiQMZKKk2PQZYeIditOuUmjiS0Xk3H8CGsLjT5UZekkYotyewiWkwjo6cCTghSaQJZmkSuaiPUh7kOpeDIExMhfhe7I+xvECu4s2tXVFEtuf/+zNICMZHEasedwM/LnmVXV3CupYqLdejQxtgCopGL2GCKi+Otx0y9whfhgpUBOTEaiKFlqjSZKQbehmOPitObbk99w3e3jMiu4WjfQh8h70uhDba4+1Yec7kO6WMztdHO7bLye326IXpH7UNH4qGtljT/lJs6hiVJxgjFIdHeSVynfHHYuAP/D7nBsc+u1dY8zK9HOQ9BQ8FOWpZTl7VQ8SDBe8u1mfzW7CcH35dVpk+dZXdhLRzcRG1mjiXVsdDkmDkFSTjOQN6ub0+Off+fr10FrPr1+nO9e3k43my3jZTMUNa6d2mZ3//D/AO4Hh7iaTmBxAAAAAElFTkSuQmCC')
        # image_url: helpers.image_url('image_name.png') # works with saved image in assets
      }
    end
  end

  def show
  end

  def new
    @cat = Cat.new
  end

  def create
    @cat = Cat.new(cat_params)
    @cat.user = current_user
    if @cat.save
      redirect_to cat_path(@cat)
    else
      render :new
    end
  end

  def destroy
    @cat.destroy
    redirect_to cats_path
  end

  private

  def set_cat
    @cat = Cat.find(params[:id])
  end

  def cat_params
    params.require(:cat).permit(:name, :address, :availability, :age, :breed, :color, :hair_type, :gender, :photo)
  end
end
